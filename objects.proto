syntax = "proto3";

package EcdarProtoBuf;

option java_multiple_files = false;
option java_package = "EcdarProtoBuf";
option java_outer_classname = "ObjectProtos";

import "component.proto";

message StateTuple {
  message LocationTuple {
    string name = 1;
    // Maybe the component name? or some comp id?
  }
  LocationTuple location = 1;
  repeated Zone federation = 2;
}

message Transition {
  // Figure out what we need here
  // repeated Edge edges = 1; //?
}

message SpecificComponent {
  string component_name = 1;
  uint32 component_index = 2;
}
message ComponentClock {
  SpecificComponent specific_component = 1;
  string clock_name = 2;
}

message Constraint {
  // This message represents if (!strict) { x - y <= c } else { x - y < c }
  ComponentClock x = 1;
  ComponentClock y = 2;
  bool strict = 3;
  int32 c = 4;
}

message Conjunction {
  repeated Constraint constraints = 1;
}

message Disjunction {
  repeated Conjunction conjunctions = 1;
}

message Zone {
  Disjunction disjunction = 1;
}

message LocationTuple {
  message Location {
    string id = 1;
    string component_name = 2;
  }
  repeated Location locations = 1;
}

message State {
  LocationTuple location_id = 1;
  Zone zone = 2;
}

message DecisionPoint {
  State source = 1;
  repeated Edge edges = 2;
}

message Edge {
  string id = 1;
  SpecificComponent specific_component = 2;
}

message Decision {
  State source = 1;
  Edge edge = 2;
}

message SimulationState {
  string component_composition = 1;
  ComponentsInfo components = 2;
  repeated DecisionPoint decision_points = 3;
}
